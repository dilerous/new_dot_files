!function(a,b,c){function d(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function e(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return l[a.which]?l[a.which]:m[a.which]?m[a.which]:String.fromCharCode(a.which).toLowerCase()}function f(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function g(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function h(a,b){var c,d,e,f=[];for(c=a,"+"===c?c=["+"]:(c=c.replace(/\+{2}/g,"+plus"),c=c.split("+")),e=0;e<c.length;++e)d=c[e],o[d]&&(d=o[d]),b&&"keypress"!=b&&n[d]&&(d=n[d],f.push("shift")),g(d)&&f.push(d);if(c=d,!(e=b)){if(!k){k={};for(var h in l)95<h&&112>h||l.hasOwnProperty(h)&&(k[l[h]]=h)}e=k[c]?"keydown":"keypress"}return"keypress"==e&&f.length&&(e="keydown"),{key:d,modifiers:f,action:e}}function i(a,c){return null!==a&&a!==b&&(a===c||i(a.parentNode,c))}function j(a){function c(a){a=a||{};var b,c=!1;for(b in q)a[b]?c=!0:q[b]=0;c||(t=!1)}function i(a,b,c,d,e,f){var h,i,j=[],k=c.type;if(!o._callbacks[a])return[];for("keyup"==k&&g(a)&&(b=[a]),h=0;h<o._callbacks[a].length;++h)if(i=o._callbacks[a][h],(d||!i.seq||q[i.seq]==i.level)&&k==i.action){var l;(l="keypress"==k&&!c.metaKey&&!c.ctrlKey)||(l=i.modifiers,l=b.sort().join(",")===l.sort().join(",")),l&&(l=d&&i.seq==d&&i.level==f,(!d&&i.combo==e||l)&&o._callbacks[a].splice(h,1),j.push(i))}return j}function k(a,b,c,d){o.stopCallback(b,b.target||b.srcElement,c,d)||!1!==a(b,c)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0)}function l(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=e(a);b&&("keyup"==a.type&&r===b?r=!1:o.handleKey(b,f(a),a))}function m(a,b,d,f){function g(b){return function(){t=b,++q[a],clearTimeout(p),p=setTimeout(c,1e3)}}function i(b){k(d,b,a),"keyup"!==f&&(r=e(b)),setTimeout(c,10)}for(var j=q[a]=0;j<b.length;++j){var l=j+1===b.length?i:g(f||h(b[j+1]).action);n(b[j],l,f,a,j)}}function n(a,b,c,d,e){o._directMap[a+":"+c]=b,a=a.replace(/\s+/g," ");var f=a.split(" ");1<f.length?m(a,f,b,c):(c=h(a,c),o._callbacks[c.key]=o._callbacks[c.key]||[],i(c.key,c.modifiers,{type:c.action},d,a,e),o._callbacks[c.key][d?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:d,level:e,combo:a}))}var o=this;if(a=a||b,!(o instanceof j))return new j(a);o.target=a,o._callbacks={},o._directMap={};var p,q={},r=!1,s=!1,t=!1;o._handleKey=function(a,b,d){var e,f=i(a,b,d);b={};var h=0,j=!1;for(e=0;e<f.length;++e)f[e].seq&&(h=Math.max(h,f[e].level));for(e=0;e<f.length;++e)f[e].seq?f[e].level==h&&(j=!0,b[f[e].seq]=1,k(f[e].callback,d,f[e].combo,f[e].seq)):j||k(f[e].callback,d,f[e].combo);f="keypress"==d.type&&s,d.type!=t||g(a)||f||c(b),s=j&&"keydown"==d.type},o._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)n(a[d],b,c)},d(a,"keypress",l),d(a,"keydown",l),d(a,"keyup",l)}if(a){var k,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},m={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},o={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(c=1;20>c;++c)l[111+c]="f"+c;for(c=0;9>=c;++c)l[c+96]=c.toString();j.prototype.bind=function(a,b,c){return a=a instanceof Array?a:[a],this._bindMultiple.call(this,a,b,c),this},j.prototype.unbind=function(a,b){return this.bind.call(this,a,function(){},b)},j.prototype.trigger=function(a,b){return this._directMap[a+":"+b]&&this._directMap[a+":"+b]({},a),this},j.prototype.reset=function(){return this._callbacks={},this._directMap={},this},j.prototype.stopCallback=function(a,b){return!(-1<(" "+b.className+" ").indexOf(" mousetrap ")||i(b,this.target))&&("INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable)},j.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},j.addKeycodes=function(a){for(var b in a)a.hasOwnProperty(b)&&(l[b]=a[b]);k=null},j.init=function(){var a,c=j(b);for(a in c)"_"!==a.charAt(0)&&(j[a]=function(a){return function(){return c[a].apply(c,arguments)}}(a))},j.init(),a.Mousetrap=j,"undefined"!=typeof module&&module.exports&&(module.exports=j),"function"==typeof define&&define.amd&&define(function(){return j})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),function(a){var b={},c=a.prototype.stopCallback;a.prototype.stopCallback=function(a,d,e,f){return!!this.paused||!b[e]&&!b[f]&&c.call(this,a,d,e)},a.prototype.bindGlobal=function(a,c,d){if(this.bind(a,c,d),a instanceof Array)for(c=0;c<a.length;c++)b[a[c]]=!0;else b[a]=!0},a.init()}(Mousetrap),function(a,b){"use strict";function c(a){a&&"input"===a.tagName.toLowerCase()&&(a.className+=" enpass-extension-animated-fill",setTimeout(function(){a&&a.className&&(a.className=a.className.replace(/(?:^|\s)enpass-extension-animated-fill(?!\S)/g,""))},200))}function d(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function e(a,b,c){if(!a||!a.ownerDocument)return!1;var d=a.ownerDocument.createEvent("KeyboardEvent");return c?(d&&d.initKeyboardEvent&&d.initKeyboardEvent(b,!0,!0,document.defaultView,!1,!1,!1,!1,c,c),d&&d.initKeyEvent&&d.initKeyEvent(b,!0,!0,null,!1,!1,!1,!1,c,0)):(d&&d.initKeyboardEvent&&(/Edge\/\d./i.test(navigator.userAgent)?d.initKeyboardEvent(b,!0,!0,null,0,0,!1,!1,!1):d.initKeyboardEvent(b,!0,!0)),d&&d.initKeyEvent&&d.initKeyEvent(b,!0,!0,null,!1,!1,!1,!1,0,0)),a.dispatchEvent(d)}function f(a,b){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0),a&&a.dispatchEvent(c)}function g(a){try{if(a&&a.ownerDocument){var b=a.ownerDocument.createEvent("Events");b.initEvent("change",!0,!0),a.dispatchEvent(b),b=a.ownerDocument.createEvent("Events"),b.initEvent("input",!0,!0),a.dispatchEvent(b),h(a,16)}}catch(c){}}function h(a,b){a.focus();var c=e(a,"keydown");return"undefined"!=typeof InstallTrigger&&c&&(c=e(a,"keypress")),c=e(a,"keyup")}function i(a,b){var c=[];a||(a=document);try{c=Array.prototype.slice.call(a.querySelectorAll(b))}catch(d){return[]}return c}function j(a){return a||(a=document),i(a,"input, select, button , textarea")}function k(a){return"string"==typeof a?a.toLowerCase():(""+a).toLowerCase()}function l(a,b,c){if(!a)return!1;a=a.toLowerCase(),a=a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,"");for(var d=0,e=b.length;d<e;d++){if(-1!==a.indexOf(b[d]))return!0;if(c){if(-1!==a.replace(/\s/gi,"").indexOf(b[d]))return!0}}return!1}function m(a){if(a.options){return{options:Array.prototype.slice.call(a.options).map(function(a){var b=a.text;return b=b?k(b).replace(/\s/gm,"").replace(/[~`!@$%^&*()\-_+=:;'"\[\]|\\,<.>\/?]/gm,""):null,[b||null,a.value]})}}return null}function n(a,b,c){void 0!==c&&null!==c&&(a[b]=c)}function o(a,b){return a&&b?a.filter(function(a){return"string"==typeof b?a.htmlType===b:b.constructor===Array&&-1!==b.indexOf(a.htmlType)}):[]}function p(a){return a?a.filter(function(a){return"button"===a.htmlType||"submit"===a.htmlType}):[]}function q(a){for(var b,c=a.ownerDocument,d=c?c.defaultView:{};a&&a!==document;){if(!(b=d.getComputedStyle?d.getComputedStyle(a,null):a.style))return!0;if("none"===b.display||"hidden"==b.visibility)return!1;a=a.parentNode}return a===document}function r(a,b){if(!a)return!1;a=a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,""),a=a.replace(/\s\s+/gi," "),a=a.trim().toLowerCase();for(var c=b.length;c--;)if(a===b[c])return!0;return!1}function s(a){var b=M(a);if(!b)return!1;if("absolute"!==b.style.position)return!0;var c=parseInt(b.style.top),d=parseInt(b.style.left),e=!0,f=!0;return!isNaN(c)&&c<0&&(e=!1),!isNaN(d)&&d<0&&(f=!1),e&&f}function t(b){var c,d=b.ownerDocument.documentElement,e=b.ownerDocument.body,f=b.getBoundingClientRect(),g=Math.max(e.scrollWidth,e.offsetWidth,d.clientWidth,d.scrollWidth,d.offsetWidth),h=Math.max(e.scrollHeight,e.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight),i=f.left-d.clientLeft,j=f.top-d.clientTop;if(!q(b)||!b.offsetParent||10>b.clientWidth||10>b.clientHeight)return!1;var k=b.getClientRects();if(0===k.length)return!1;for(var l=0,m=k.length;l<m;l++)if(c=k[l],c.left>g||0>c.right)return!1;if(0>i||i>g||0>j||j>h)return!1;var n,o=i+(f.right>a.innerWidth?(a.innerWidth-i)/2:f.width/2),p=j+(f.bottom>a.innerHeight?(a.innerHeight-j)/2:f.height/2);for(n=b.ownerDocument.elementFromPoint(o,p);n&&n!==b&&b!==document;){var r=n.tagName,s=!!r&&"string"==typeof n.tagName,t=!!r&&"label"===n.tagName.toLowerCase();if(r&&s&&t&&b.labels&&b.labels.length>0)return Array.prototype.slice.call(b.labels).indexOf(n)>=0;n=n.parentNode}return n===b}function u(a,b){var c=a[b];return c&&"string"==typeof c?c:(c=a.getAttribute(b),c&&"string"==typeof c?c:null)}function v(a){if(!a)return null;var b=null;return(b=a.textContent||a.innerText)?(b=b.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi," "),b=b.replace(/\&lt;br\&gt;/gi,"\n").replace(/(&lt;([^&gt;]+)&gt;)/gi," "),b=b.replace(/\s/g," "),b=b.trim().toLowerCase()):null}function w(a){var b=null;return a&&(b=a.replace(/^\s+|\s+$|\r?\n.*$/gm,""),b=0<b.length?b:null),b?b.toLowerCase():""}function x(a){return a?a.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi," "):null}function y(a){var b,c,d,e,f=[];if(a.labels&&a.labels.length&&0<a.labels.length)f=Array.prototype.slice.call(a.labels);else{if(a.id&&(f=f.concat(i(a,"label[for="+JSON.stringify(a.id)+"]"))),a.name){b=i(a,"label[for="+JSON.stringify(a.name)+"]");for(var g=0;g<b.length;g++){var h=b[g];-1===f.indexOf(h)&&f.push(h)}}for(var j=a,k=a.ownerDocument;j&&j!=k;j=j.parentNode){var l=a.tagName;"label"===("string"==typeof l?l.toLowerCase():(""+l).toLowerCase())&&-1===f.indexOf(j)&&f.push(j)}}if(0===f.length&&(c=a.parentNode,d=c.previousElementSibling,"td"===c.tagName.toLowerCase()&&null!==d&&"td"===d.tagName.toLowerCase()))try{e=d.querySelectorAll("input,select,textarea"),0===e.length&&f.push(d)}catch(m){}if(0===f.length&&(c=a.parentNode,d=c.previousElementSibling,"dd"===c.tagName.toLowerCase()&&null!==d&&"dt"===d.tagName.toLowerCase()))try{e=d.querySelectorAll("input,select,textarea"),0===e.length&&f.push(d)}catch(m){}if(f.length>0){return x(f.map(function(a){return v(a)}).join(""))}return null}function z(a,b){var c;return!!a&&(c=a?(a.tagName||"").toLowerCase():"",b.constructor===Array?b.indexOf(c)>=0:b===c)}function A(a){var b=!a||void 0===a||z(a,"select option input form textarea button table iframe body head script a".split(" "));if(!b){if(z(a,"label")&&a.hasAttribute("for")){var c=a.getAttribute("for");if(document.getElementById(c)||document.getElementsByName(c)>0)return!0}return!(!a||void 0===a||1!==a.nodeType)&&a.querySelectorAll("select,option,input,form,textarea,button,table,iframe,body,head,script").length>0}return b}function B(a){var b;for(a=a.parentElement||a.parentNode;a&&"td"!==k(a.tagName);)a=a.parentElement||a.parentNode;return a&&void 0!==a?(b=a.parentElement||a.parentNode,"tr"!==b.tagName.toLowerCase()?null:!(b=b.previousElementSibling)||"tr"!=(b.tagName+"").toLowerCase()||b.cells&&a.cellIndex>=b.cells.length?null:(b=b.cells[a.cellIndex],A(b)?null:(a=w(b.textContent),x(a)))):null}function C(a){var b="";return 3===a.nodeType?b=a.nodeValue:1===a.nodeType&&(b=a.textContent||a.innerText),b=w(b),b?b.toLowerCase():""}function D(a){var b=[];return E(a,b),b=b.reverse().join(""),x(b)}function E(a,b){for(var c,d;a&&a.previousSibling;){if(a=a.previousSibling,A(a))return"";d=C(a),d&&b.push(d)}if(a&&0===b.length)for(c=null;!c;){if(!(a=a.parentElement||a.parentNode))return;for(c=a.previousSibling;c&&!A(c)&&c.lastChild;)c=c.lastChild}A(c)||(d=C(c),d&&b.push(d),0===b.length&&E(c,b))}function F(a){for(var b=[],c=a;c&&c.nextSibling&&(c=c.nextSibling,!A(c));)b.push(C(c));return x(b.join(""))}function G(a){if(!a||0===a.length)return[];for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=0,g=/(?:answer.*(?:security|hint|secret|challenge))|(?:(?:security|hint|secret|challenge).*answer)|(?:e.?mail.*alert)|gift|promo|coupon|maiden|comment|messageq|search|keyword|ordercode|conditions|captcha|imageword|txtspamcheck|turing|anti_spam_code|invoice|(?:PO\\s*#)|(?:purchase.*order)|(?:customer\\s*po)|(?:referrer)|(?:redress)|voucher|discount.*code|promo.*code|campaign.*code|(?:^|[^i])pcode/i;f+=g.test(e.htmlName)?10:0,f+=g.test(e.htmlID)?10:0,f+=g.test(e.htmlTitle)?5:0,f+=g.test(e.htmlPlaceholder)?5:0;var h=0;h+=!h&&g.test(e.htmlLabel)?10:0,h+=!h&&g.test(e.labelTop)?5:0,h+=!h&&g.test(e.labelRight)?5:0,h+=!h&&g.test(e.labelLeft)?5:0,h+=!h&&g.test(e.labelData)?5:0,h+=!h&&g.test(e.labelAria)?5:0,f+=h,0===f&&b.push(e)}return b}function H(a,b){var c=[];if(!a)return c;for(var d=0,e=a.length;d<e;d++)b?a[d].visible||c.push(a[d]):a[d].visible&&c.push(a[d]);return c}function I(a,b){var c=[];if(!a)return c;for(var d=0,e=a.length;d<e;d++)b?a[d].viewable||c.push(a[d]):a[d].viewable&&c.push(a[d]);return c}function J(a){if(!a)return"";var b=a.children;if(b&&b.length>0)for(var c=0,d=b.length;c<d;c++){var e=b[c],f=e.textContent||e.value;if(q(e)&&f)return f}return a.textContent||a.value}function K(a){return a||(a=document),j(a).map(function(a,b){var c={},d="__"+b,e=999,f=-1==a.maxLength?e:a.maxLength;return(!f||"number"==typeof f&&isNaN(f))&&(f=e),a.setAttribute("data-enpassid",d),c.elementNumber=d,c.visible=q(a),c.viewable=t(a),c.hasForm=!!a.form,n(c,"htmlID",u(a,"id")),n(c,"htmlName",u(a,"name")),n(c,"htmlClass",u(a,"class")),n(c,"tabindex",u(a,"tabindex")),n(c,"htmlTitle",u(a,"title")),n(c,"userEdited",!!a.dataset["enpass.usermodified"]),n(c,"rel",u(a,"rel")),n(c,"htmlType",k(u(a,"type"))),a.tagName&&"button"===a.tagName.toLowerCase()?n(c,"htmlValue",J(a)):n(c,"htmlValue",a.value||a.textContent),c&&c.htmlType&&"image"===c.htmlType&&(n(c,"imageAlt",u(a,"alt")),n(c,"imageSrc",u(a,"src"))),n(c,"checked",a.checked),n(c,"autoCompleteType",a.getAttribute("x-autocompletetype")||a.getAttribute("autocompletetype")||a.getAttribute("autocomplete")),n(c,"disabled",a.disabled),n(c,"readonly",a.readonly),n(c,"selectOption",m(a)),n(c,"aria-hidden","true"==a.getAttribute("aria-hidden")),n(c,"aria-disabled","true"==a.getAttribute("aria-disabled")),n(c,"aria-haspopup","true"==a.getAttribute("aria-haspopup")),n(c,"data-unmasked",a.dataset.unmasked),n(c,"data-stripe",u(a,"data-stripe")),"hidden"!==k(a.type)&&(n(c,"htmlLength",f),n(c,"htmlLabel",y(a)),n(c,"labelData",u(a,"data-label")),n(c,"labelAria",u(a,"aria-label")),n(c,"labelTop",B(a)),n(c,"labelRight",F(a)),n(c,"labelLeft",D(a)),n(c,"htmlPlaceholder",u(a,"placeholder"))),c})}function L(a,b){if(!a)return null;for(var c=[],d=0,e=a.length;d<e;d++){var f={},g=a[d],h=g.getAttribute("action"),i=g.getAttribute("id"),j=g.getAttribute("name"),k=g.getAttribute("method");"string"==typeof h&&""!==h&&(f.htmlAction=h),"string"==typeof i&&""!==i&&(f.htmlID=i),"string"==typeof j&&""!==j&&(f.htmlName=j),"string"==typeof k&&""!==k&&(f.htmlMethod=k),b.length>0&&b[d]&&(f.fields=b[d]),f.location=g.ownerDocument.URL,f.domain=g.ownerDocument.domain,c.push(f)}return c}function M(a){var b=null;return a&&a.elementNumber&&(b=document.querySelector("[data-enpassid="+a.elementNumber+"]")),a&&a.htmlID&&!b&&(b=document.getElementById(a.htmlID)),b}function N(a){var b=null,c=null;return a&&a.hasForm&&(c=M(a))&&(b=c.form),b}function O(a){var b=[],c=[],d=[],e=[];if(!a)return null;for(var f=0,g=a.length;f<g;f++){var h=a[f],i=null,j=null;h.htmlType&&"hidden"===h.htmlType||(h.hasForm?(i=N(h),j=b.indexOf(i),-1===j&&i?(b.push(i),j=b.length-1,c[j]?c[0].push(h):c.push([h])):c[j].push(h)):d.push(h))}b.length>0&&(e=L(b,c));var k={totalFields:a};return e.length&&(k.pageForms=e),d.length&&(k.pageFields=d),Object.keys(k).length?k:null}function P(a,b){if(a&&0===a.length)return null;for(var c=null,d=-1,e=0;e<a.length;++e){var f=b(a[e]);f>0&&f>d&&(d=f,c=a[e])}return c}function Q(a,b){return a&&b?(Object.keys(b).forEach(function(c){a[c]=b[c]}),a):a||null}function R(b){if(!b)return!1;var c=document.createEvent("UIEvent");/Edge\/\d./i.test(navigator.userAgent)?c.initEvent("submit",!0,!0):c.initEvent("submit",!0,!0,a,1),b.dispatchEvent(c);try{b.submit()}catch(d){}return!0}function S(a,b){if(!a||""===a)return!1;var c=a.replace(/^\s+/m,"").replace(/\s+$/m,"").replace(/\s\s+/," ").toLowerCase().trim();return b.some(function(b){return"function"==typeof b.test?b.test(a)||b.test(c):0<=c.indexOf(b)})}function T(a,b,c){var d=2,e=.5;c||(d=10,e=5);var f=0,g=0;if(!a)return 0;if(a.constructor===Array){if(0===a.length)return 0;for(var h=0;h<a.length;++h)if(r(a[h].toLowerCase(),b)){f=d;break}for(var i=0;i<a.length;++i)if(l(a[i].toLowerCase(),b)){g=e;break}}else f=r(a.toLowerCase(),b)?d:0,g=l(a.toLowerCase(),b)?e:0;return f>=g?f:g}function U(a){var b=0,c="current password,current,old,old password".split(","),d=("currentpassword,password_old,old_password,oldpass,oldLogonPassword,current_password,curpass".split(","),/(current|old|curpass)/i);if(a&&"password"===a.htmlType){b+=d.test(a.htmlName)?10:0,b+=d.test(a.htmlID)?10:0,b+=d.test(a.htmlClass)?5:0,b+=d.test(a.htmlTitle)?5:0,a.htmlPlaceholder&&(b+=r(a.htmlPlaceholder,c)?10:0);var e=0;return e+=!e&&l(a.htmlLabel,c)?10:0,e+=e||a.htmlPlaceholder||!l(a.labelTop,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelRight,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelLeft,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelData,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelAria,c)?0:5,b+e}return b}function V(a){var b=0,c="new,new password,password".split(","),d=("password_new,newpass,newPassword,newLogonPassword,logonPassword,new_password1".split(","),/(new|logon|password1)/i);if(a&&"password"===a.htmlType){var e=0,f=/(current|old.*pass|pass.*old|curpass|verify|retype|again|re\s?enter)/i;if(e+=f.test(a.htmlName)?10:0,e+=f.test(a.htmlID)?10:0,e+=f.test(a.htmlClass)?5:0,e+=f.test(a.htmlTitle)?5:0,e+=f.test(a.htmlPlaceholder)?5:0,(e+=f.test(a.htmlLabel)?5:0)>0)return 0;b+=d.test(a.htmlName)?10:0,b+=d.test(a.htmlID)?10:0,b+=d.test(a.htmlClass)?5:0,b+=d.test(a.htmlTitle)?5:0,a.htmlPlaceholder&&(b+=r(a.htmlPlaceholder,c)?10:0);var g=0;return g+=!g&&r(a.htmlLabel,c)?20:0,g+=!g&&l(a.htmlLabel,c)?10:0,g+=g||a.htmlPlaceholder||!l(a.labelTop,c)||f.test(a.labelTop)?0:5,g+=g||a.htmlPlaceholder||!l(a.labelRight,c)||f.test(a.labelRight)?0:5,g+=g||a.htmlPlaceholder||!l(a.labelLeft,c)||f.test(a.labelLeft)?0:5,g+=g||a.htmlPlaceholder||!l(a.labelData,c)||f.test(a.labelData)?0:5,g+=g||a.htmlPlaceholder||!l(a.labelAria,c)||f.test(a.labelAria)?0:5,b+g}return b}function W(a){var b=0,c="new password confirmation,retype new,retype password,confirm new password,confirm password,reenter new password,reenter your new password".split(","),d=("password_confirm,logonPasswordVerify,password-confirm,retypeNewPassword,repass,reenterpass,new_password2".split(","),/(confirm|re\s?enter|verify|retype|again|password2)/i);if(a&&"password"===a.htmlType){b+=d.test(a.htmlName)?10:0,b+=d.test(a.htmlID)?10:0,b+=d.test(a.htmlClass)?5:0,b+=d.test(a.htmlTitle)?5:0,a.htmlPlaceholder&&(b+=r(a.htmlPlaceholder,c)?10:0);var e=0;return e+=!e&&l(a.htmlLabel,c)?10:0,e+=e||a.htmlPlaceholder||!l(a.labelTop,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelRight,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelLeft,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelData,c)?0:5,e+=e||a.htmlPlaceholder||!l(a.labelAria,c)?0:5,b+e}return b}function X(a){var b=0,c="save changes,change password,save,update,save password,update password,update changes".split(","),d=("save_password".split(","),/(save|update|change)/i);return!a||"submit"!==a.htmlType&&"button"!==a.htmlType?b:(b+=d.test(a.htmlName)?10:0,b+=d.test(a.htmlID)?10:0,b+=d.test(a.htmlClass)?5:0,b+=d.test(a.htmlTitle)?5:0,a.htmlValue&&(b+=r(a.htmlValue,c)?10:0),b)}function Y(a){return Z(a,X)}function Z(a,b){var c=P(a,b);return null!==c&&b(c)>0?c:null}function $(a){if(a){var b=Z(a,U),c=Z(a,V),d=Z(a,W),e=Y(a),f={};return b&&(f.currentPasswordField=b),c&&(f.newPasswordField=c),d&&(f.confirmPasswordField=d),e&&(f.changePasswordButton=e),Object.keys(f).length?f:null}return null}function _(a){return a?a.map(function(a){return Q(a,$(H(a.fields)))}):[]}function aa(a){var b=0;if(!a)return b;var c=/(update|change|security)/i,d=/(signup|sign\s?[io]n|log[io]n|access|reg|create)/i,e=p(a.fields),f=0;if(e&&e.length>0)for(var g=0,h=e.length;g<h;g++){var i=e[g];if(f+=d.test(i.htmlName)?2:0,f+=d.test(i.htmlID)?2:0,(f+=d.test(i.htmlValue)?2:0)>0)return-1e3}if(b+=a.currentPasswordField?2:0,b+=a.newPasswordField?2:0,b+=a.confirmPasswordField?2:0,(b+=a.changePasswordButton?2:0)>0){if(f+=d.test(a.htmlName)?2:0,f+=d.test(a.htmlID)?2:0,(f+=d.test(a.htmlClass)?2:0)>0)return-1e3;b+=c.test(a.htmlName)?2:0,b+=c.test(a.htmlID)?2:0,b+=c.test(a.htmlClass)?2:0}return b}function ba(a){a&&0!==a.length||(a=K());var b=null;if(a){var c=O(a);if(c&&c.pageForms&&c.pageForms.length){var d=_(c.pageForms);if(d&&(b=P(d,aa))&&aa(b)>0)return b}if(c&&c.pageFields&&c.pageFields.length){var e=$(c.pageFields);if(e&&e.newPasswordField&&e.currentPasswordField)return e}}return null}function ca(){var a=!!Ca();sb();chrome.runtime.sendMessage({header:"shortcutPressed",isLogin:a,tabUrl:fa(),tabId:yb.tabId})}function da(a){var b=null;if(b=a.hasOwnProperty("userField")||a.hasOwnProperty("pswdField")?a:za(a)){var c=b.userField?b.userField.htmlValue:null,d=b.userFieldAuthentic?b.userFieldAuthentic.htmlValue:null,e=b.pswdField?b.pswdField.htmlValue:null;if(c&&-1!==c.indexOf("****")&&d&&!/^[.*]+$/g.test(d)&&-1!==(location.hostname+location.pathname).indexOf("online.citi.com/US")&&(c=d),e&&!/^[.*]+$/g.test(e)){if("bot"===c&&"bot"===e)return;c?chrome.runtime.sendMessage({header:"loginSubmitEvent",username:c,password:e,tabId:yb.tabId}):chrome.runtime.sendMessage({header:"loginSubmitEvent",password:e,tabId:yb.tabId})}}}function ea(a){var b=a.getAttribute("placeholder")||"",c=a.getAttribute("class")||"",d=a.getAttribute("id")||"",e=a.getAttribute("name")||"",f=/(search|find|zoek|поиск|найти|искать|recherche|suchen|buscar|suche|ricerca|procurar|検索)/i;return b.match(f)||c.match(f)||d.match(f)||e.match(f)?null:a}function fa(){var b=parent!==a;return b?document.referrer:a.location.href}function ga(){var a=K(),b=[];if(a&&a.length>0&&(b=a.filter(function(a){if(a&&a.userEdited)return!0})),b&&b.length>0)if(ta(a)){var c=ba(a);if(c){var d="",e="";c.currentPasswordField&&(d=c.currentPasswordField.htmlValue),c.newPasswordField&&(e=c.newPasswordField.htmlValue),!e&&c.confirmPasswordField&&(e=c.confirmPasswordField.htmlValue),e&&d?chrome.runtime.sendMessage({header:"changePswdSubmitEvent",newPassword:e,oldPassword:d}):e&&chrome.runtime.sendMessage({header:"changePswdSubmitEvent",newPassword:e})}}else{var f=ka(a);f&&da(f)}}function ha(){for(var a=Array.prototype.slice.call(document.querySelectorAll("input[type=password]")),b=0,c=a.length;b<c;b++)if(a[b].value)return!0;return!1}function ia(a){var b=a.ownerDocument.querySelectorAll("[role=button]");if(b)for(var c=b.length,d=0;d<c;d++){var e=b[d];if(e.contains(a))return e}return null}function ja(a,b){if(!a||!b)return null;if(-1!==["button","input"].indexOf(a.tagName.toLowerCase())){if(("button"===a.tagName.toLowerCase()&&!a.hasAttribute("type")||"button"===a.type.toLowerCase())&&(S(a.textContent,b)||S(a.value,b)))return a;if(-1!==["submit","image"].indexOf(a.type.toLowerCase())){var c=ma();return c<50?a:null}}else if(a){var d=a.getAttribute("data-action");if(d&&(d=d.replace(/^\s+/m,"").replace(/\s+$/m,"").replace(/\s\s+/," ").toLowerCase().trim(),d.indexOf("submit")>=0)){var e=a.textContent||a.value;if(!("div"!==a.tagName.toLowerCase()||!a.classList.contains("button"))&&(e&&S(e,b)&&!S(e,["already have an account","sign in with"])))return a}}for(var f=3,g=null;a&&a!==document&&f>=0;){var h=a.textContent||a.value||g;if(h&&-1!==["a","button"].indexOf(a.tagName.toLowerCase())&&(a.hasAttribute("type")&&"submit"===a.type.toLowerCase()||h&&S(h,b)&&!S(h,["already have an account","sign in with"])))return a;a=a.parentNode,f--}return a=null}function ka(a){if(!a)return null;if(a&&a.length>0){var b=za(a,!0);if(b)return b}return null}function la(a){if(ha()){var b=a?a.target:this,c=[/^\W*log\W*[oi]n\W*$/i,/log\W*[oi]n (?:securely|now)/i,/\W*secure\W*log\W*[oi]n/i,/^\W*sign\W*[oi]n\W*$/i,/create.*account/i,"continue","submit","weiter","ingresar","accès","вход","connexion","entrar","anmelden","accedi","valider","登录","登 录","लॉग इन करें","register","sign up","signup","join","create my account","регистрация","inscription","regístrate","cadastre-se","registrieren","registrazione","注册","vstoupit","войти","साइन अप करें","change password","save changes"],d=ja(b,c);d?ga():(b=ia(b))&&(b.getAttribute("title")&&c.indexOf(b.getAttribute("title").toLowerCase())>=0||b.getAttribute("alt")&&c.indexOf(b.getAttribute("alt").toLowerCase())>=0)&&ga()}}function ma(){for(var a=document.getElementsByTagName("button"),b=[],c=0,d=a.length;c<d;c++)"submit"==a[c].type&&b.push(a[c]);return b.length}var na=["sign-in","log-in","signon","sign on","login","log in","login_in","signin","sign in","sign_in","log on","log_on","logon","登 录","登录","Inloggen","einloggen","giriş","zaloguj","लॉग इन करें","valider","accedi","anmelden","weiter","accès","вход","kirjaudu","zaloguj się","let me in","credentials","authentication","authenticate","prijava"],oa=["signup","sign_up","sign up","register","create","reg","join","start","free","trial"],pa=["change","change-password","creditcard","dc-form","cc-form","creditcard-form","debitcard-form","creditcard-payment-form","debitcard-payment-form","payment"],qa=function(a,b,c){var d=[/^\W*log\W*[oi]n\W*$/i,/log\W*[oi]n (?:securely|now)/i,/^\W*sign\W*[oi]n\W*$/i,"continue","submit","weiter","accès","accéder","вход","connexion","entrar","anmelden","accedi","valider","登录","ログイン","登 录","लॉग इन करें","einloggen","inloggen","ingresar","giriş","zaloguj","σύνδεση","kirjaudu","vstoupit","войти","prijava"],e=["ok","next","næste","let me in","go","unlock","dalej"],f=[],g=["forgot","remember me","stay logged in","new user","view","register","registration","s'inscrire","vergessen","already have an account","sign in with","register","sign up","signup","join","create","регистрация","inscription","regístrate","cadastre-se","registrieren","registrazione","注册","साइन अप करें","change password","save changes"];f=c&&c.length>0?c:d;var h=a.htmlValue||a.imageAlt,i=!1,j=0;if(h&&a.viewable){if(S(h,g))return b?j:i;j+=S(h,f)&&!S(h,g)?10:0,0===j&&(j+=S(h,e)&&!S(h,g)?5:0),j>0&&(j+=a.htmlType&&"submit"===a.htmlType?5:0,i=!0)}return(!h||!i&&a.viewable)&&(j+=S(a.htmlID,f)?10:0,j+=S(a.htmlName,f)?10:0,j+=S(a.htmlClass,f)?5:0,j+=l(a.imageAlt,f)?10:0,(j+=l(a.imageSrc,f)?10:0)>=10&&(j+=a.htmlType&&"submit"===a.htmlType?5:0,i=!0)),b?j:i},ra=function(a){var b=[/^\W*log\W*[oi]n\W*$/i,/log\W*[oi]n (?:securely|now)/i,/\W*secure\W*log\W*[oi]n/i,/^\W*sign\W*[oi]n\W*$/i,"continue","submit","weiter","accéder","accès","вход","connexion","entrar","anmelden","accedi","valider","登录","ログイン","登 录","लॉग इन करें","einloggen","inloggen","giriş","zaloguj","kirjaudu","ingresar","σύνδεση","se connecter","vstoupit","войти","prijava"],c=["forgot","remember me","stay logged in","new user","view","register","s'inscrire","vergessen","already have an account","sign in with","register","sign up","signup","join","create my account","регистрация","inscription","regístrate","cadastre-se","registrieren","registrazione","注册","साइन अप करें","change password","save changes"],d=i(null,"div[class*=btn],div[class*=button],a[class*=btn],a[class*=button],a[id*=btn],div[class*=Btn],div[class*=Button],a[class*=Btn],a[class*=Button],a[id*=Btn],a[role=button]"),e=0,f=null;if(d&&d.length>0)for(var g,h=d.length,j=0;j<h;j++){var k=0;if((g=d[j])&&q(g)){var l=g.textContent||"";if((k+=S(l,b)&&!S(l,c)?10:0)>0){var m=g.getAttribute("data-action");if(m=m?m.replace(/^\s+/m,"").replace(/\s+$/m,"").replace(/\s\s+/," ").toLowerCase().trim():"",k+=m&&m.indexOf("submit")>=0?10:0,a){var n=M(a);n.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_FOLLOWING?k+=10:k=0}g.tagName&&"div"===g.tagName.toLowerCase()&&g.firstElementChild&&(k=k>0?k/2:0)}}k>0&&k>e&&(e=k,f=g)}return f},sa=function(a,b,c){if(!a||0===a.length)return null;var d=o(a,["submit","button","image"]),e=0,f=null;if(d&&d.length>0){for(var g=d.length,h=0;h<g;h+=1){var i=d[h];if(c){var j=parseInt(c.elementNumber.substr(2));if(parseInt(i.elementNumber.substr(2))<j)continue}var k=qa(i,!0,b);if(k>0){if(i.hasForm&&c&&c.hasForm){k+=N(i)===N(c)?50:0}k>e&&(e=k,f=i)}}return f}return null},ta=function(a){var b=o(a,"password");if(b=b.filter(function(a){return""!==a.htmlValue&&a.visible}),3===b.length){var c=b[0].htmlValue,d=b[1].htmlValue,e=b[2].htmlValue,f=N(b[0]),g=N(b[1]),h=N(b[2]);if(c===d&&c===e)return!1;var i=[];if(c.length>0&&-1===i.indexOf(c)&&i.push(c),d.length>0&&-1===i.indexOf(d)&&i.push(d),e.length>0&&-1===i.indexOf(e)&&i.push(e),2===i.length)return!(f&&g&&h)||f===g&&g===h}return!(o(a,["text","email"]).length>0)&&(2===b.length&&b[0].htmlValue===b[1].htmlValue)},ua=function(a,b,c){if(!a)return 0;var d=a.htmlType,e=0;if("text"===d||"email"===d||"password"===d||"number"===d){var f="email or phone,email id or phone number,username,user name,login name,usuari,identificación,identifiant,användar,käyttäjätunnus,user id,登录名,用户名,CPR-nummer,Social Security number,bruger-id,registration number,customer id,online id,login id,personal id,customer number,registered email,account name,member number,membership number,profile number,profile id,cust no,cust id".toLowerCase().split(","),g=/(?:(?:login)|(?:logon.*id)|(?:login.*id)|(?:user)|(?:uname)|(?:user.*(email))|(?:signup.*(email))|(?:profile.*(id|number))|(?:member.*number)|(?:account.*name)|(?:customer.*(number|id))|(?:regist.*(email|number))|(?:cust.*(no|id))|(?:personal.*id)|(?:online.*id))(?!.*pass)/i,h=/(bot|dummy|fake|password)/i,i=parseInt(a.elementNumber.substr(2));if("password"!==d&&b&&b.length>0){if(!b.every(function(a){return i<a}))return 0}else if("password"===d&&b&&b.length>0){var j=b.some(function(a){return i===a});if(j)return 0}c&&(e+=a.htmlValue?50:0,e+=a.userEdited?50:0),e+="email"===d?1:0,e+="password"===d?-1:0,e+=h.test(a.htmlName)?-100:0,e+=h.test(a.htmlID)?-100:0,e+=h.test(a.htmlClass)?-5:0,e+=h.test(a.htmlTitle)?-100:0,e+=g.test(a.htmlName)?10:0,e+=g.test(a.htmlID)?10:0,e+=g.test(a.htmlClass)?5:0,e+=g.test(a.htmlTitle)?5:0,a.userEdited||(e+=r(a.htmlValue,f)?10:0),a.htmlPlaceholder&&(e+=r(a.htmlPlaceholder,f)?10:0);var k=0;return a.visible&&(k+=!k&&l(a.htmlLabel,f)?10:0,k+=k||a.htmlPlaceholder||!l(a.labelTop,f)?0:5,k+=k||a.htmlPlaceholder||!l(a.labelRight,f)?0:5,k+=k||a.htmlPlaceholder||!l(a.labelLeft,f)?0:5,k+=k||a.htmlPlaceholder||!l(a.labelData,f)?0:5,k+=k||a.htmlPlaceholder||!l(a.labelAria,f)?0:5),e+=k,e>0&&(a.viewable?e>=10&&(e+=10):e>=10&&(e/=2)),e}return 0},va=function(a,b,c){if(!a||0===a.length)return null;var d=o(a,"password"),e=[];e=b?[b]:d.map(function(a){return parseInt(a.elementNumber.substr(2))});for(var f=a.length,g=null,h=-1,i=f;i--;){var j=a[i],k=ua(j,e,c);k>0&&k>h&&(h=k,g=j)}return g},wa=function(a,b){if(a){var c=/(masked)/i,d=0;if(d+=c.test(a.htmlName)?10:0,d+=c.test(a.htmlID)?10:0,d+=c.test(a.htmlClass)?5:0,(d+=c.test(a.htmlTitle)?5:0)>0)return!0}},xa=function(a){if(!a&&0===a.length)return[];for(var b=["cvv","cvv2","cvc2","cvv number","verification code","security code","otp","optional","one-time","dummy"],c=["dummy","bot","vcc","cardpincode","cv2_number","ccvnumber","ccvnum","cvvvnum","verifycardcode","cardverificationcode","dccvv","cccvv","security_code","security-code","cardsecuritycode","securitycode","cc.security","cvc_code","cvccode","cccode","cvv","cvv2","cvv2/cvc2","cvv/cvc","cardcsc"],d=[],e=a.length;e--;){var f=a[e],g=0;"password"===f.htmlType?(g+=f.htmlPlaceholder&&l(f.htmlPlaceholder,b)?100:0,g+=f.htmlID&&l(f.htmlID,c)?100:0,g+=f.htmlName&&l(f.htmlName,b)?100:0,
g+=f.htmlLength&&f.htmlLength<=4?100:0,0===(g+=f.htmlLabel&&l(f.htmlLabel,b)?100:0)&&d.push(a[e])):d.push(a[e])}return d.reverse()},ya=function(a,b){if(!a||0===a.length)return null;for(var c=a.length,d=0,e=null,f=["password","passwort","kennwort","hasło","salasana","पासवर्ड","密码","пароль","wachtwoord","adgangskode","contraseña","senha","mot de passe"],g=["password","login","mot de passe"],h=/(register|registration|signup)/i,i=0;i<c;i+=1){var j=a[i],k=0,m=0;if(j.visible){k+=l(j.htmlID,g)?10:0,k+=l(j.htmlName,g)?10:0,k+=l(j.htmlPlaceholder,f)?10:0,m+=h.test(j.htmlID)?10:0,m+=h.test(j.htmlName)?10:0,m+=h.test(j.htmlPlaceholder)?10:0;var n=0;n+=!n&&l(j.htmlLabel,f)?10:0,n+=n||j.htmlPlaceholder||!l(j.labelTop,f)?0:5,n+=n||j.htmlPlaceholder||!l(j.labelRight,f)?0:5,n+=n||j.htmlPlaceholder||!l(j.labelLeft,f)?0:5,n+=n||j.htmlPlaceholder||!l(j.labelData,f)?0:5,n+=n||j.htmlPlaceholder||!l(j.labelAria,f)?0:5,k+=n,(k>0||b)&&(k+=j.htmlValue&&j.htmlValue.length>1?50:0,k+=j.userEdited?50:0),k>0&&j.viewable&&(k+=20),m&&(k/=2),k>0&&k>d&&(d=k,e=j)}}return e},za=function(a,b){if(!a||0===a.length)return null;var c=H(a),d=G(c),e=o(d,"password"),f=null,g=null,h=null;if((e=xa(e))&&e.length>0)(f=ya(e,b))||(f=e.sort(function(a,b){return a.htmlValue.length-b.htmlValue.length}),f=f&&f.constructor===Array&&f.length>0?f[0]:null);else{var i=/((\b|_|-)pin(\b|_|-)|password|passwort|kennwort|(\b|_|-)passe(\b|_|-)|contraseña|senha|密码|adgangskode|hasło|wachtwoord)/i;if(d&&d.length>0){var j=d.filter(function(a){if("checkbox"!==a.htmlType&&"textarea"!==a.htmlType&&"submit"!==a.htmlType&&"button"!==a.htmlType&&(i.test(a.htmlID)||i.test(a.htmlName)||i.test(a.htmlPlaceholder)||i.test(a.htmlLabel)||i.test(a["label-tag"])||i.test(a["label-data"])||i.test(a["label-aria"])))return!0});j&&j.length>0&&(f=j.sort(function(a,b){return a.htmlValue.length-b.htmlValue.length}),f=f&&f.constructor===Array&&f.length>0?f[0]:null)}}if(d&&d.length>0&&!(g=f&&f.elementNumber?va(d,parseInt(f.elementNumber.substr(2)),b):va(d,null,b))&&f)for(var k=d.length,l=parseInt(f.elementNumber.substr(2)),m=k;m--;){var n=d[m],p=n.htmlType,q=parseInt(n.elementNumber.substr(2));if(q<=l&&("text"===p||"email"===p||"number"===p||"tel"===p)){g=n;break}}g&&f&&g===f&&("password"===f.htmlType?g=null:f=null);var r={};if(g&&s(g)){if(wa(g)&&-1!==(location.hostname+location.pathname).indexOf("online.citi.com/US")){var t=H(a,!0),u=G(t),v=null;u&&u.length&&(v=f&&f.elementNumber?va(u,parseInt(f.elementNumber.substr(2)),b):va(u,null,b))}r.userField=g,r.userFieldAuthentic=v||null}else g=null;if(f&&s(f)?r.pswdField=f:f=null,f||g)if(h=sa(d,null,f))r.loginButton={type:"dict",target:h};else{var w=ra(f);w&&(r.loginButton={type:"pointer",target:w})}return r.userField||r.pswdField?r:null},Aa=function(a){var b=0,c=0,d=0,e=0,f=[];if(!a)return b;if(a.fields&&(f=H(a.fields))&&(0===f.length||1===f.length&&("submit"===f[0].htmlType||"button"===f[0].htmlType)))return b;var g=G(f);if(ta(g))return b;var h=za(a.fields);return h&&(h.userField&&(c+=h.userField.viewable?30:10),h.pswdField&&(c+=h.pswdField.viewable?30:10),h.loginButton&&("dict"===h.loginButton.type&&h.loginButton.target&&(c+=h.loginButton.target.viewable?30:10),"pointer"===h.loginButton.type&&h.loginButton.target&&(c+=t(h.loginButton.target)?30:10))),b+=l(a.htmlID,na)?10:0,b+=l(a.htmlName,na)?10:0,b+=l(a.htmlClass,na)?5:0,d+=l(a.htmlID,pa)?10:0,d+=l(a.htmlName,pa)?10:0,d+=l(a.htmlClass,pa)?5:0,e+=l(a.htmlID,oa)?5:0,e+=l(a.htmlName,oa)?5:0,e+=l(a.htmlClass,oa)?5:0,d>0?b-=d:e>0?b=c>0?(b+c)/4:5:b+=c,b},Ba=function(a){var b=location.hostname+location.pathname;return a&&0===a.length?null:-1!==b.indexOf("accounts.google.com")?a[0]:null},Ca=function(a){var b=[],c=[],d=null,e=null;if(a)c=a;else if(b=K(),(c=O(b))&&c.pageForms&&1===c.pageForms.length){var f=c.pageForms[0];if(f.fields&&1===f.fields.length&&"password"===f.fields[0].htmlType){var g=o(b,"text");g&&1===g.length&&(c={pageFields:b})}}if(!c)return null;if(c&&c.pageForms){d=P(c.pageForms,Aa);if(-1===(location.hostname+location.pathname).indexOf("accounts.google.com")&&d&&!d.pswdField){if(document.querySelector('input[type="password"]')&&(e=za(c.totalFields))&&Object.keys(e).length>0)return{type:"login_fields",loginFields:e}}if(null!==d&&Aa(d)>0)return d}if(!d){var h=Ba(c.pageForms);if(h)return h;if(c&&c.pageFields&&(e=za(c.pageFields))&&Object.keys(e).length>0)return{type:"login_fields",loginFields:e}}return null},Da=function(a,b){if(!a)return!1;if(a&&a.userFieldAuthentic){var c=M(a.userFieldAuthentic);c&&(c.value=b.username)}if(a&&a.userField){var d=M(a.userField);d&&(d.hasAttribute("value")&&d.removeAttribute("value"),d.hasAttribute("readonly")&&(d.readOnly=!1),b&&b.username&&Ga(d,b.username))}if(a&&a.pswdField){var e=M(a.pswdField),g=!1;if("text"===a.pswdField.htmlType){var h=i(null,"input[type=password]");if(h&&h.length>0){var j=h.filter(function(a){return!q(a)});j&&j.length>0&&(f(e,"focus"),j.forEach(function(a){q(a)&&(a.value=b.password,g=!0)}))}}e&&b&&b.password&&!g&&Ga(e,b.password)}},Ea=function(a){if("www.icloud.com"===location.hostname||"idmsa.apple.com"===location.hostname){var b=document.getElementById("sign-in");b&&b.click()}return!1},Fa=function(a,b){if(a&&b){var c=null;a&&"login_fields"===a.type?(c=a.loginFields,Da(c,b)):(c=za(a.fields),Da(c,b)),b.autosubmit_login&&b.password&&setTimeout(function(){if(!Ea(a))if(c&&c.loginButton){if("pointer"===c.loginButton.type&&c.loginButton.target){var b=c.loginButton.target;if(b&&b.querySelector){var d=b.querySelector("button");if(d)return void d.click()}b.click()}if("dict"===c.loginButton.type&&c.loginButton.target){var e=M(c.loginButton.target);e&&e.click()}}else if(a.htmlAction&&-1===a.htmlAction.indexOf(".aspx")&&-1===a.htmlAction.indexOf("./")&&"post"===a.htmlMethod){var f=c.userField||c.pswdField;if(f){var g=M(f);g&&R(g.form)}}},600)}},Ga=function(a,b){a&&b&&(a.value=b,Ha()&&g(a),a.value!==b&&(a.value=b),c(a))},Ha=function(){var a=document.domain;return-1===a.indexOf("mailfence.com")&&-1===a.indexOf("yesbank")&&-1===a.indexOf("mynycb")&&-1===a.indexOf("centier")&&-1===a.indexOf("mcode")&&-1===a.indexOf("vivo")&&-1===a.indexOf("mlslistings.com")},Ia=function(a,b){if(a&&b){if(-1!==(location.hostname+location.pathname).indexOf("accounts.google.com")){var c=a&&a.fields?a.fields:[],d=(c&&c.length,c?o(c,"email"):null),e=document.querySelectorAll('input[type="password"]');if(d&&1===d.length&&d[0]&&d[0].visible){var f=M(d[0]),g=document.querySelector("#next")||document.querySelector("#identifierNext"),h=function(){Ga(f,b.username)},i=function(){g&&g.click()},j=function(){e=document.querySelectorAll('input[type="password"]');for(var a=0,c=e.length;a<c;a++){var d=e[a];if(d&&q(d)){Ga(d,b.password);break}}},k=function(){if(b.autosubmit_login){var c=document.querySelector("#passwordNext");if(c)c.click();else if(a&&"login_fields"!==a.type){var d=M(a);d&&R(d)}}},l=0,m=[h,i,j,k],n=function(){m[l++](),l<m.length&&setTimeout(n,400+200*l)};n()}if(e&&e.length>0){for(var p=0,r=e.length;p<r;p++){var s=e[p];if(s&&q(s)){Ga(s,b.password);break}}var t=document.querySelector("#passwordNext");t&&b.autosubmit_login&&setTimeout(function(){t.click()},500)}else Fa(a,b)}else Fa(a,b)}},Ja=function(a){var b=Array.prototype.slice.call(document.querySelectorAll("input[type=password]"))||[];b.length>0&&b.forEach(function(b){"none"!==b.style.display&&""===b.value&&Ga(b,a)})},Ka=["creditcard","dc-form","cc-form","creditcard-form","debitcard-form","creditcard-payment-form","debitcard-payment-form","payment"],La=["debit card number","credit card number","card number","credit card no","debit card no","card no"],Ma=["creditcard","crdnumbr","card_number","cardnumber","creditcardnumber","cccardnumber","debitcardnumber","dccardnumber","ccnumber","cardno","card_no","cc-number","cardnum","ccnum","cc_no","ccno","dcnum"],Na=["cvv","cvv2","cvc2","cvc","cvv number","verification code","security code"],Oa=["cardcvc","cvc","cv2_number","ccvnumber","ccvnum","cvvvnum","verifycardcode","cardverificationcode","dccvv","cccvv","security_code","security-code","cardsecuritycode","securitycode","cc.security","cvc_code","cvccode","cccode","cvv","cvv2","cvv2/cvc2","cvv/cvc","cardcsc","vccpincode"],Pa=["crdexpr","card_exp_month","expmonth","expirymonth","expirationmonth","ccexpirymonth","ccexpymonth","dcexpirymonth","dcexpymonth","card_month","cardmonth","month","debitmonth","expdate_month","exmnth","cc_valid_month","cardexpirymonth","enddate","end-month","end_month","cc-exp-month","ccexpmon","vccmonth","vdcmonth","month_vcc","month_vdc"],Qa=["crdexpr","card_exp_year","expyear","expiryyear","expirationyear","ccexpiryyear","ccexpyyear","dcexpiryyear","dcexpyyear","creditcard_year","card_year","cardyear","year","debityear","expdate_year","exyr","cc_valid_year","cardexpiryyear","enddate","end-year","end_year","cc-exp-year","ccexpyr","vccyear","vdcyear","year_vdc","year_vcc"],Ra=["expires","expiry year","expiry month","expiry year","expiry date","expiry","expiration date","valid thru","valid to","end date","valid till"],Sa=["expiry","expiration","card-expiration","expirationdate","expiration_date","expiration-date","expdate","exp_date","ccvaliddate","cc-valid-date","cc_valid_date","enddate","end_date","end-date","cc_exp_date","ccexpdate","cc-exp-date","crdexpr"],Ta=["cardholder's name","card holder's name","cardholder name","card holder name as it appears on card","card holders name","cardholder","name on card","name as on card","name on credit card","name on the card","name on debit card","first name","card owner","card holder name"],Ua=["card-holder","name-card","name_card","namecard","bill_name","vccname","ccname","dcname","cname","name_on_card","nameoncard","creditcardname","card_name","cardname","cardholder","cardholdername","card_holder_name","card_holder","cardowner","card_owner"],Va=["creditcardtype","cardtype","type","type_of_card"],Wa=["card type","credit card type","payment type"],Xa=["birthdate","birthday_month","birthday_year","birthday","startdate","startmonth","startyear","start_month","monthstart","month_start","yearstart","year_start","start_year","start_date"],Ya="january,february,march,april,may,june,july,august,september,october,novemeber,december".split(","),Za="jan,feb,mar,apr,may,june,july,aug,spet,oct,nov,dec".split(","),$a=1e3,_a=function(a){var b=0,c=0;if(a){if(!a.viewable)return-$a;if("tel"!==a.htmlType&&"text"!==a.htmlType&&"number"!==a.htmlType)return-$a;if(a.htmlLength){var d=a.htmlLength;c=15===d||16===d||19===d?2:0}var e=0,f=/(expiry|holder|name|year|month)/i;if(e+=f.test(a.htmlID)?2:0,e+=f.test(a.htmlName)?2:0,e+=f.test(a.htmlLabel)?2:0,(e+=f.test(a.htmlPlaceholder)?2:0)>0)return-$a;if(b+=T(a.htmlID,Ma),b+=T(a.htmlName,Ma),b+=T(a.htmlClass,Ma,!0),b+=T(a.htmlPlaceholder,La),b+=T(a.htmlLabel,La),b+=T(a.labelAria,La,!0),b+=T(a.labelData,La,!0),!a.htmlLabel){var g=0;g+=T(a.labelLeft,La,!0),g+=g?0:T(a.labelRight,La,!0),g+=g?0:T(a.labelTop,La,!0),b+=g}return c?b+c:b}},ab=function(a){var b=P(a,_a);return null!==b&&_a(b)>0?b:null},bb=function(a,b,c){var d=0,e=a.htmlType,f=a.htmlLength,g=a.htmlName,h=a.htmlID;if(!a.viewable)return-$a;if("text"!==e&&"number"!==e&&"tel"!==e)return-$a;if(c)for(var i=0;i<c.length;++i){var j=c[i];if(a.elementNumber===j.elementNumber)return-$a;var l=j.htmlName,m=j.htmlID;l&&g&&(l=l.substring(0,l.length-1),g=g.substring(0,g.length-1),d+=g===l?2:0),m&&h&&(m=m.substring(0,m.length-1),h=h.substring(0,h.length-1),d+=h===m?2:0)}if(b&&f){if(d+=4!==b||4!==f&&7!==f?0:2,d+=5===b&&3===f?2:0,d+=b<4&&4===f?2:0,f<3||f>7)return-$a;g&&g[g.length-1]===b.toString()&&(d+=2),h&&h[h.length-1]===b.toString()&&(d+=2)}return d+=T(g,Ma),d+=T(h,Ma),1===b&&(d+=T(k(a.htmlLabel),La)),d+=T(a.htmlClass,Ma,!0)},cb=function(a,b,c){var d=P(a,function(a){return bb(a,b,c)});return null!==d&&bb(d,b,c)>0?d:null},db=function(a){var b=0,c=a.htmlType;if(!a.viewable)return-$a;if("password"!==c&&"text"!==c&&"tel"!==c&&"number"!==c)return-$a;!a.htmlLength||3!==a.htmlLength&&4!==a.htmlLength||(b+=2),b+=T(a.htmlLabel,Na),b+=T(a.htmlPlaceholder,Na),b+=T(a.htmlName,Oa),b+=T(a.htmlID,Oa),b+=T(a.htmlClass,Oa,!0);var d=0,e=["crdnumbr","card_number","cardnumber","creditcardnumber","cccardnumber","debitcardnumber","dccardnumber","ccnumber","cardno","card_no","cc-number","cardnum","ccnum","cc_no","ccno","dcnum"];return(d=T(a.htmlName,e))>0?-$a:(d=T(a.htmlID,e),d>0?-$a:b)},eb=function(a){var b=P(a,db);return null!==b&&db(b)>0?b:null},fb=function(a,b){var c=0,d=a;if(void 0===b&&(b=!1),!a.viewable&&!b)return-$a;if("select-one"===d.htmlType){var e=d.selectOption.options.length,f=null;if(12===e&&(f=d.selectOption.options[11][0]),13===e&&(f=d.selectOption.options[12][0]),!f)return-$a;f=f.toLowerCase(),c+="12"===f||"dec"===f||"december"===f||"12dec"===f||"dec12"===f||"12december"===f||"december12"===f||"12 - dec"===f||"dec - 12"===f||"12 - december"===f||"december (12)"===f||"12 (dec)"===f||"dec (12)"===f?2:0}else{var g=a.htmlType;if("text"!==g&&"tel"!==g&&"number"!==g)return-$a;if(a.htmlPlaceholder){c+="mm"===a.htmlPlaceholder.toLowerCase()?2:0}a.htmlLength&&(c+=2===a.htmlLength?2:0)}c+=T(a.htmlName,Pa),c+=T(a.htmlID,Pa),c+=T(a.htmlClass,Pa,!0),c+=T(a.htmlLabel,Ra);var h=0;return(h=T(a.htmlLabel,Xa))>0?-$a:(h=T(a.htmlName,Xa))>0?-$a:(h=T(a.htmlID,Xa),h>0?-$a:c)},gb=function(a,b){var c=P(a,function(a){return fb(a,b)});return null!==c&&fb(c,b)>0?c:null},hb=function(a,b){var c=0,d=a;if(void 0===b&&(b=!1),!a.viewable&&!b)return-$a;if("select-one"===d.htmlType&&d.selectOption.options.length>1){var e=new Date,f=e.getFullYear(),g=parseInt(f.toString().substr(2,2),10),h=parseInt(d.selectOption.options[0][0],10),i=parseInt(d.selectOption.options[1][0],10);f!==h&&f!==i&&g!==h&&g!==i||(c+=2)}else{var j=a.htmlType;if("text"!==j&&"tel"!==j&&"number"!==j)return-$a;if(a.htmlPlaceholder){var k=a.htmlPlaceholder.toLowerCase();c+="yy"===k||"yyyy"===k||"year"===k?10:0}a.htmlLength&&0!==c&&(a.htmlName&&-1===a.htmlName.indexOf("cvv")||a.htmlID&&-1===a.htmlID.indexOf("cvv")||a.htmlLabel&&-1===a.htmlLabel.indexOf("cvv"))&&(c+=2===a.htmlLength||4===a.htmlLength?2:0)}c+=T(a.htmlName,Qa),c+=T(a.htmlID,Qa),c+=T(a.htmlClass,Qa,!0),c+=T(a.htmlLabel,Ra,!0);var l=0;return(l=T(a.htmlLabel,Xa))>0?-$a:(l=T(a.htmlName,Xa))>0?-$a:(l=T(a.htmlID,Xa),l>0?-$a:c)},ib=function(a,b){var c=P(a,function(a){return hb(a,b)});return null!==c&&hb(c,b)>0?c:null},jb=function(a){var b=0,c=a.htmlType;if(!a.viewable)return-$a;if("tel"!==c&&"text"!==c)return-$a;if(b+=T(a.htmlName,Sa),b+=T(a.htmlID,Sa),b+=T(a.htmlLabel,Ra),b+=T(a.htmlClass,Sa),b+=T(a.htmlPlaceholder,["mm yyyy"]),b+=T(a.autoCompleteType,Sa),!a.htmlLabel){var d=0;d+=T(a.labelLeft,Ra,!0),d+=d?0:T(a.labelRight,Ra,!0),d+=d?0:T(a.labelTop,Ra,!0),b+=d}return b>0&&(5===a.htmlLength||7===a.htmlLength)&&(b+=2),b},kb=function(a){var b=P(a,jb);return null!==b&&jb(b)>0?b:null},lb=function(a){var b=0;if(!a.viewable)return-$a;if("text"!==a.htmlType)return-$a;b+=T(a.htmlLabel,Ta,!0),b+=T(a.htmlID,Ua,!0),b+=T(a.htmlName,Ua,!0),b+=T(a.htmlClass,Ua),b+=T(a.htmlPlaceholder,Ta,!0);var c=0;return(c=T(a.htmlLabel,["save","number"]))>0?-$a:(c=T(a.htmlName,["save"]))>0?-$a:(c=T(a.htmlID,["save"]),c>0?-$a:b)},mb=function(a){var b=P(a,lb);return null!==b&&lb(b)>0?b:null},nb=function(a,b){var c=0,d=a.selectOption?a.selectOption.options.length:0;if(void 0===b&&(b=!1),!a.viewable&&!b)return-$a;if(!(d>1))return-$a;for(var e=0;e<d;++e){var f=a.selectOption.options[e][0]?a.selectOption.options[e][0].toLowerCase():a.selectOption.options[e][0];if("visa"===f||"american express"===f||"discover"===f||"mastercard"===f||"visa electron"===f||"mastercard maestro"===f||"diners club"===f){c+=2;break}}return c+=T(a.htmlName,Va),c+=T(a.htmlID,Va),c+=T(a.htmlClass,Va),c+=T(a.htmlLabel,Wa)},ob=function(a,b){var c=P(a,function(a){return nb(a,b)});return null!==c&&nb(c)>0?c:null},pb=function(a){if(!a||!a.length)return{};var b=H(a,!1),c=ab(b),d=mb(b),e=ob(b),f=eb(b),g=gb(b),h=ib(b),i=[],j=null,k=cb(b,1);k&&i.push(k);var l=cb(b,2,i);l&&i.push(l);var m=cb(b,3,i);m&&i.push(m);var n=cb(b,4,i);n&&i.push(n);var o=null;n&&4===n.htmlLength&&(o=cb(b,5,i)),o&&i.push(o);var p=I(a,!0);return g||(g=gb(p,!0)),h||(h=ib(p,!0)),e||(e=ob(p,!0)),g||h||(!g&&!h||g&&h&&g.elementNumber===h.elementNumber)&&(j=kb(a)),{cardNumberField:i.length>=4?null:c,cardNumberFields:i,cardHolderField:d,cardTypeField:e,cvvField:f,monthField:g,yearField:h,expiryField:j}},qb=function(a){return a?a.map(function(a){return Q(a,pb(a.fields))}):[]},rb=function(a){var b=0;return a.cardNumberField||a.cardNumberFields.length>=4?(b+=2,b+=a.cardHolderField?2:0,b+=a.cardTypeField?2:0,b+=a.cvvField?2:0,b+=a.monthField?2:0,b+=a.yearField?2:0,b>0&&(b+=T(a.htmlName,Ka),b+=T(a.htmlID,Ka),b+=T(a.htmlClass,Ka)),b):-$a},sb=function(a){var b=null,c=[],d=[];if(a?d=a:(c=K(),d=O(c)),!d)return null;if(d){var e=d;if(e&&e.pageForms&&e.pageForms.length){var d=qb(e.pageForms);if(d&&(b=P(d,rb))&&rb(b)>0)return b}if(!b&&e&&e.pageFields&&e.pageFields.length){var f=pb(e.pageFields);return f.cardNumberField?f:null}}return null},tb=function(a,b,e){if(!a||!b)return!1;try{var h=document.querySelector("[data-enpassid="+a.elementNumber+"]");if(h){var i=h.nodeName;if("INPUT"===i&&(h.value="year"===e&&2===a.htmlLength&&4===b.length?b.substr(2,2):b,c(h),g(h)),"SELECT"===i)for(var j=0,k=a.selectOption.options.length;j<k;++j){var l=a.selectOption.options[j],m=l&&l[0]?l[0].toLowerCase():"",n=l&&l[1]?l[1].toLowerCase():"",o=b,p=b;if("year"===e&&(m&&4===m.length&&4!==b.length&&(o="20"+b),n&&4===n.length&&(b.substr(2,2),4!==b.length&&(p="20"+b)),m&&2===m.length&&2!==b.length&&(o=b.substr(2,2)),n&&2===n.length&&2!==b.length&&(n=b.substr(2,2))),m===o.toLowerCase()||n===p.toLowerCase()){h.selectedIndex=j,f(h,"change");break}if(!isNaN(b)){var q=b;if(1===b.length&&(q=d(q,2)),2===b.length){if(q=parseInt(q,10),"month"===e&&(-1!==m.indexOf(Ya[q-1])||-1!==m.indexOf(Za[q-1])||-1!==n.indexOf(Za[q-1])||-1!==n.indexOf(Ya[q-1]))){h.selectedIndex=j,g(h);break}q=q.toString()}if(m===q.toLowerCase()||n===q.toLowerCase()){h.selectedIndex=j,g(h);break}}}}}catch(r){}},ub=function(a,b){var c=0,d=b.ccnumber,e=0,f=4;if(a&&(!a||a.cardNumberField&&a.cardNumberField.viewable)&&(!a||a.cardNumberField||a.cardNumberFields)){if(a.cardTypeField&&tb(a.cardTypeField,b.cardtype,"cardtype"),a.cardNumberField&&tb(a.cardNumberField,b.ccnumber),a&&a.cardNumberFields&&3===a.cardNumberFields.length&&(d=b.ccnumber,e=0,f=a.cardNumberFields[0].htmlLength||4,tb(a.cardNumberFields[0],d.substring(e,f)),e=f,f=f+a.cardNumberFields[1].htmlLength||f+6,tb(a.cardNumberFields[1],d.substring(e,f)),e=f,tb(a.cardNumberFields[2],d.substring(e))),a.cardNumberFields.length>=4&&(c=a.cardNumberFields.length,d=b.ccnumber,e=0,f=4,tb(a.cardNumberFields[0],d.substring(e,f)),e=f,f+=4,tb(a.cardNumberFields[1],d.substring(e,f)),e=f,f+=4,tb(a.cardNumberFields[2],d.substring(e,f)),4===c?(e=f,tb(a.cardNumberFields[3],d.substring(e))):(e=f,f+=4,tb(a.cardNumberFields[3],d.substring(e,f)),e=f,tb(a.cardNumberFields[4],d.substring(e)))),a.cardHolderField&&tb(a.cardHolderField,b.holderName),a.monthField&&tb(a.monthField,b.month,"month"),a.yearField&&tb(a.yearField,b.year,"year"),a.expiryField){var g=b.month,h=b.year,i=a.expiryField.htmlLength,j=a.expiryField;j.value=g,tb(j,g),5===i?tb(j,g+h.substr(2)):7===i?tb(j,g+h):tb(j,g+"/"+h)}a.cvvField&&tb(a.cvvField,b.cvv)}},vb=null,wb=null,xb={},yb={};document.addEventListener("DOMContentLoaded",function(a){chrome.runtime.sendMessage({header:"get_shortcut"})}),a.addEventListener("keydown",function(a){var b=a.target.type;if(13===a.keyCode&&("password"===b||"text"===b||"email"===b)){ea(a.target)&&ga()}},!0),chrome.runtime.onMessage.addListener(function(a,c,d){switch(a.header){case"setActiveTabInfo":delete a.header,yb=a;break;case"enpass_loginfill":vb=Ca(),vb&&(Ia(vb,a.card),a=null);break;case"enpass_cardfill":wb||(wb=sb()),ub(wb,a.card),a=null;break;case"guess_form":var e=K(),f=O(e);vb=Ca(f),vb?chrome.runtime.sendMessage({header:"guess_form_result",isLogin:!0}):(wb=sb(f))&&chrome.runtime.sendMessage({header:"guess_form_result",isCreditCard:!0});break;case"set_shortcut_for_autofill":if(a.shortcutKey){var g=a.shortcutKey.toLowerCase();xb&&xb.keyShortcut&&b.unbind(xb.keyShortcut),xb.keyShortcut=g,b.bindGlobal(xb.keyShortcut,function(){ca()},"keydown")}else xb&&xb.keyShortcut&&b.unbind(xb.keyShortcut);break;case"fillGeneratedPassword":a.generatedPassword&&Ja(a.generatedPassword)}}),document.addEventListener("input",function(a){"input"===a.target.tagName.toLowerCase()&&(a.target.dataset["enpass.usermodified"]="yes")},!0),document.addEventListener("click",la,!0)}(window,Mousetrap);